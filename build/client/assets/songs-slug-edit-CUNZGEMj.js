import{w as b,A as y,a as S,o as t,t as I}from"./chunk-NL6KNZEE-CxvR8bn4.js";import{M as z,U as E}from"./song-ByDppcAO.js";import{S as A}from"./artist-C-xmUNrL.js";import{I as d}from"./input-xm3ORQld.js";import{B as F}from"./button-DLC1agRu.js";import{u as B,p as C}from"./hooks-PJGK5Pe1.js";import{u as p}from"./integrations-Cf1gwroS.js";import{g as O,a as r}from"./helpers-CZocgdl2.js";import"./index-B3T0X-bt.js";import"./utils-bRKmu4jq.js";import"./createLucideIcon-8xFrFlUl.js";import"./lyric-DRC73VJJ.js";function H({}){return[{title:"Lyrifix - Edit Song"},{name:"description",content:"Edit song"}]}const J=b(function({loaderData:x,actionData:u}){var c;const{song:a,artists:g,uploadcarePublicKey:f}=x,o=y().state==="submitting",[h,s]=B({onValidate({formData:e}){return C(e,{schema:E})},lastResult:u,shouldValidate:"onBlur",shouldRevalidate:"onBlur",defaultValue:{id:a.id,imageUrl:a.imageUrl??"",title:a.title,artistIds:((c=a.artists)==null?void 0:c.map(e=>e.id))??[],spotifyUrl:a.spotifyUrl??""}}),n=g.map(e=>({value:e.id,label:e.name})),j=p(s.artistIds),m=p(s.imageUrl),[N,v]=S.useState(n.filter(e=>{var i;return(i=a.artists)==null?void 0:i.some(l=>l.id===e.value)})),U=e=>{v(e);const i=e.map(l=>l.value);j.change(i)};return t.jsx("div",{className:"my-8",children:t.jsxs(I,{method:"post",...O(h),className:"mr-4 ml-4",children:[t.jsx("input",{...r(s.id,{type:"hidden"})}),t.jsxs("label",{className:"mb-10 flex cursor-pointer flex-col items-center",htmlFor:s.imageUrl.id,children:[t.jsx(A,{value:m.value,onChange:m.change,publicKey:f}),t.jsx("input",{...r(s.imageUrl,{type:"text"}),className:"hidden"})]}),t.jsx("p",{className:"text-sm text-red-500",children:s.imageUrl.errors}),t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx(d,{...r(s.title,{type:"text"}),placeholder:"Title",className:"border-zinc-700 bg-zinc-800"}),t.jsx("p",{className:"text-sm text-red-500",children:s.title.errors})]}),t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx(z,{defaultOptions:n,artistOptions:N,handleChangeArtistOptions:U,id:"artist",placeholder:"Type artist name...",className:"border-zinc-700 bg-zinc-800"}),t.jsx("p",{className:"text-sm text-red-500",children:s.artistIds.errors})]}),t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx(d,{...r(s.spotifyUrl,{type:"text"}),placeholder:"Spotify URL",className:"border-zinc-700 bg-zinc-800"}),t.jsx("p",{className:"text-sm text-red-500",children:s.spotifyUrl.errors})]})]}),t.jsx("div",{className:"mt-14",children:t.jsx(F,{className:"w-full",disabled:o,children:o?"Saving...":"Save"})})]})})});export{J as default,H as meta};
