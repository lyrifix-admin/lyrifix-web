import{a as o}from"./chunk-NL6KNZEE-CxvR8bn4.js";import{b as p}from"./hooks-PJGK5Pe1.js";function b(r){return document.forms.namedItem(r)}function v(r,n){var u=r==null?void 0:r.elements.namedItem(n),e=u?u instanceof Element?[u]:Array.from(u.values()):[];return e.filter(t=>t instanceof HTMLInputElement||t instanceof HTMLSelectElement||t instanceof HTMLTextAreaElement)}function y(r,n,u){var e,t=v(r,n);if(t.length>1){var i=u;for(var a of t)if(!(typeof i<"u"&&a instanceof HTMLInputElement&&a.type==="checkbox"&&(a.checked?i.includes(a.value):!i.includes(a.value))))return a}return(e=t[0])!==null&&e!==void 0?e:null}function E(r,n,u){var e=document.createElement("select"),t=typeof u=="string"?[u]:u??[];e.name=n,e.multiple=Array.isArray(u),e.dataset.conform="true",e.setAttribute("aria-hidden","true"),e.tabIndex=-1,e.style.position="absolute",e.style.width="1px",e.style.height="1px",e.style.padding="0",e.style.margin="-1px",e.style.overflow="hidden",e.style.clip="rect(0,0,0,0)",e.style.whiteSpace="nowrap",e.style.border="0";for(var i of t)e.options.add(new Option(i,i,!0,!0));return r.appendChild(e),e}function m(r){return r.dataset.conform==="true"}function h(r){if(r instanceof HTMLSelectElement){var n,u=Array.from(r.selectedOptions).map(e=>e.value);return r.multiple?u:(n=u[0])!==null&&n!==void 0?n:null}return r instanceof HTMLInputElement&&(r.type==="radio"||r.type==="checkbox")?r.checked?r.value:null:r.value}function g(r){var n=o.useRef(null),u=o.useRef(null),e=o.useRef({change:!1,focus:!1,blur:!1});return o.useEffect(()=>{var t=l=>s=>{var f=n.current;f&&s.target===f&&(e.current[l]=!0)},i=t("change"),a=t("focus"),c=t("blur");return document.addEventListener("input",i,!0),document.addEventListener("focusin",a,!0),document.addEventListener("focusout",c,!0),()=>{document.removeEventListener("input",i,!0),document.removeEventListener("focusin",a,!0),document.removeEventListener("focusout",c,!0)}},[n]),o.useMemo(()=>({change(t){if(!e.current.change){e.current.change=!0;var i=n.current;i&&(p(i,{value:t}),i.dispatchEvent(new InputEvent("input",{bubbles:!0})),i.dispatchEvent(new Event("change",{bubbles:!0})))}e.current.change=!1},focus(){if(!e.current.focus){e.current.focus=!0;var t=n.current;t&&(t.dispatchEvent(new FocusEvent("focusin",{bubbles:!0})),t.dispatchEvent(new FocusEvent("focus")))}e.current.focus=!1},blur(){if(!e.current.blur){e.current.blur=!0;var t=n.current;t&&(t.dispatchEvent(new FocusEvent("focusout",{bubbles:!0})),t.dispatchEvent(new FocusEvent("blur")))}e.current.blur=!1},register(t){n.current=t,u.current&&(u.current.disconnect(),u.current=null),t&&(u.current=new MutationObserver(i=>{var a=function(){if(c.type==="attributes"){var s,f=(s=h(t))!==null&&s!==void 0?s:void 0;r(d=>f===d||JSON.stringify(d)===JSON.stringify(f)?d:f)}};for(var c of i)a()}),u.current.observe(t,{attributes:!0,attributeFilter:["data-conform"]}))}}),[r])}function w(r){var n=()=>{var a;return typeof r.initialValue=="string"?r.initialValue:(a=r.initialValue)===null||a===void 0?void 0:a.map(c=>c??"")},[u,e]=o.useState(r.key),[t,i]=o.useState(n);return u!==r.key&&(i(n),e(r.key)),[t,i]}function H(r){var[n,u]=w(r),e=o.useRef(!1),{register:t,change:i,focus:a,blur:c}=g(u);return o.useEffect(()=>{var l=b(r.formId);if(!l){console.warn("useInputControl is unable to find form#".concat(r.formId," and identify if a dummy input is required"));return}var s=y(l,r.name);return!s&&typeof n<"u"&&(!Array.isArray(n)||n.length>0)&&(s=E(l,r.name,n)),t(s),e.current?i(n??""):e.current=!0,()=>{t(null);var f=v(l,r.name);for(var d of f)m(d)&&d.remove()}},[r.formId,r.name,n,i,t]),{value:n,change:u,focus:a,blur:c}}export{H as u};
